# Standard Geometries for Fusion Data

## Project Overview

Geometries describe the size, shape, and location of boundaries, actuators, and diagnostic systems within fusion devices. Fusion device design, construction, assembly, and operation require their concise description, providing the spatial foundation for all engineering and physics analyses.

Fusion simulation and experimental data requires precise geometric context to maintain physical meaning and enable cross-facility comparison. Without explicit links to geometric information, this data cannot support reproducible analysis or meaningful integration between different diagnostic systems and simulation codes. Without geometric context, a magnetic field measurement represents merely a number, but when linked to precise sensor position and orientation data, it becomes a vector field component that can be integrated with other measurements to reconstruct the full magnetic equilibrium. Geometries establish the spatial relationships that allow datasets from different sources to combine meaningfully. Fusion research therefore requires an interoperable specification for defining and sharing geometric data.

The geometric context encompasses measurements from magnetic sensors, plasma diagnostics, and electromagnetic coils, but extends beyond instrumentation to include the machine itself with detailed geometric specification of the first wall shape, divertor structures, passive conducting elements, and active magnetic coil configurations. Data itself frequently takes geometric form, such as the shape of the last closed flux surface, location of divertor strike points, magnetic separatrix topology, and plasma-facing component boundaries. This comprehensive range of geometric information from hardware specifications to derived plasma properties demands an interoperable geometry specification format that accommodates both static machine components and dynamic plasma-derived geometries.

The project creates portable, interoperable geometry representations that serve as concrete interfaces for fusion device modeling. The IMAS Data Dictionary provides multiple routes for describing geometries, but this flexibility ultimately reduces dataset interoperability when different implementations choose different representation approaches. Geometrical data must be stored with similar fidelity to the signals that cross interfaces, requiring standardized geometry definitions rather than multiple optional pathways. These standardized geometry definitions will enable adoption across different simulation codes and experimental facilities while maintaining consistency with Fusion Convention standards. The implementation emphasizes practical data exchange specifications that support both simplified representations for fast calculations and detailed descriptions for high-fidelity simulations.

The project will redefine CF convention geometry containers to support fusion applications. Key concepts such as specifying geometry containers as metadata-only variables, explicit links to coordinate systems, and the facility to transform between coordinates shall be maintained. Cartography-specific features shall be removed and new geometrical entities such as point and area vectors shall be implemented. This redefinition extends the CF Convention approach to accommodate the complex coordinate system requirements and specialized geometries unique to tokamak devices while preserving the fundamental principles of portable, self-describing geometric data.

Tokamak geometries require both cylindrical coordinates (R, phi, Z) for natural representation of toroidal symmetry, Cartesian coordinates (X, Y, Z) for compatibility with general simulation codes, and specialized flux coordinates to store and share the results of advanced plasma calculations. Geometry containers following CF Convention standards provide the framework for maintaining these coordinate system relationships while ensuring data portability between different analysis tools and simulation environments.

This workplan covers a short duration project focused on developing geometry standards for the pf_active, pf_passive, wall, and magnetics IDSs, which represent the fundamental geometric components required for electromagnetic modeling and plasma equilibrium reconstruction in fusion devices.

## Phase 1: Fusion Conventions for Geometries

The first phase establishes the technical foundation by extending the [ITER Fusion Conventions](https://github.com/iterorganization/Fusion-Conventions) to document tokamak geometry requirements.

The geometry container approach from [CF Conventions](https://cfconventions.org/) shall be extended for tokamak-specific static geometric elements with standardized component identification systems. Extensions to CF convention geometric entities shall include point vectors. The project will extend Fusion Conventions to include specifications for geometry containers that permit geometrical data to be attached to data variables in a similar fashion to the specification of a data variable's standard name. This approach enables data variables to reference geometry containers through metadata attributes, establishing explicit links between measurements and their spatial context without duplicating coordinate information. Any concepts requiring fallback to CF Conventions shall be marked for future inclusion in the Fusion Conventions repository.

Coordinate systems shall be defined for cylindrical coordinates (R, phi, Z) where R is the major radius, phi is the toroidal angle, and Z is the vertical coordinate, alongside Cartesian coordinates (X, Y, Z) with proper transformation relationships and links to a well-defined datum. Curvilinear coordinates shall also be supported. While functional coordinate transformations to and from flux coordinates are considered infeasible, sufficient metadata linking the coordinates with source equilibrium data shall be provided to enable external codes to perform such transforms.

Interfaces shall be specified using the human-readable Common Data Language (CDL) format. Datasets shall initially follow existing IDS namespacing conventions - for example, geometries describing active poloidal field system components should be placed in a pf_active CDL file.

A namespacing strategy for geometrical variables within the same file shall be developed and documented. The recommended approach uses the geometry container name as a namespace prefix for all related variables. For instance, if a `coil_geometry` container defines PF coil poloidal cross-sections, the radial and vertical coordinates of coil boundaries would be named `coil_boundary_r` and `coil_boundary_z` respectively.

Documentation of Fusion Convention geometries in the Fusion Conventions repository forms the primary deliverable of this phase, establishing the foundational geometric standards that will guide all subsequent CDL development work.

## Phase 2: Core Geometry Development

The second phase develops core schemas for fundamental geometric representations using the established coordinate systems, geometric components and geometry container standards developed in Phase 1. The project should build a composable system of json-schemas that shall be used to validate geometric entities and their associated data variables.

Validation rules shall include but are not limited to: standard_names for all coordinate variables, geometry containers as metadata-only variables, radius is always positive, line variables have at least one point, unit vectors are of unit length, polygons have at least three points, closed polygons have a repeated last point. The schemas shall be developed in such a way that, when used to validate a dataset, they are able to identify geometry containers, such as via the `geometry` metadata attached to data variables, and validate their contents.

The schemas must enforce coordinate system consistency and provide validation for common geometric primitives including points, lines, polygons, and surfaces. Each geometric entity schema shall specify required coordinate variables, dimensional constraints, and metadata attributes necessary for proper geometric interpretation. The validation system shall support both simple geometric shapes and complex composite structures while maintaining compatibility with the geometry container approach established in Phase 1.

repository. These schemas form the primary deliverable of this phase, providing the validation infrastructure that ensures geometric data consistency and correctness across all subsequent IDS implementations.

## Phase 3: IDS-Specific Implementation

Phase three implements CDL files that define concrete interfaces for each specific IDS using the established coordinate systems, geometry containers, and geometry schemas from previous phases. The development follows a multi-machine application approach, creating geometry containers for ITER, WEST, and MAST tokamaks to ensure broad applicability.

All geometries required to describe machine components and diagnostic data covered by the `pf_active`, `pf_passive`, `wall`, and `magnetics` Interface Data Structures shall be implemented. Template CDL files that define the data organization and format requirements for these components without containing the actual geometric data values shall be created or extended in the definitions directory of the [imas-standard-interfaces](https://github.com/iterorganization/imas-standard-interfaces) repository. Data for each machine shall be stored in a single file with separate IDSs defined as groups at the root level. We refer to this data structure here as a `data-tree`.

The primary deliverables of Phase 3 include template CDL files for pf_active, pf_passive, wall, and magnetics geometries in the imas-standard-interfaces repository, and populated netCDF or Zarr files containing actual geometric data for ITER, WEST, and MAST tokamaks with linked experimental data where available.

## Phase 4: Integration and Validation

The final phase ensures consistency across all CDL interface definitions with ITER Fusion Convention standards and validates their practical implementation with existing IMAS data.
Processing scripts shall be developed within the imas-standard-names repository to automatically convert CDL definitions into json-schemas. These schemas will be composed with the base json-schemas developed in Phase 2 to produce a single schema capable of validating the geometries of full data-trees containing multiple IDS in a single pass. The build process of this project will be developed to include GitHub actions to upload this overall schema to Zenodo on tagged GitHub releases. The DOI of the overall schema shall be included as metadata for the data tree root and all child IDSs. The validation schema shall be run on the three data-trees produced in Phase 3 to assert compliance with the developed schema.

The key deliverables of Phase 4 include processing scripts for CDL-to-schema conversion, a comprehensive validation schema for full data-trees, automated GitHub actions for Zenodo uploads, DOI metadata integration, and validated compliance testing of all Phase 3 data-trees.

## Key Technical Requirements

The implementation centers on extending ITER Fusion Conventions to define geometry containers that attach geometrical data to data variables through metadata attributes, establishing the primary innovation that enables explicit spatial context without coordinate duplication. From this foundation, the project must define standardized coordinate systems for cylindrical coordinates (R, phi, Z) and Cartesian coordinates (X, Y, Z) with proper transformation relationships and datum specification that support the geometry container framework. The geometry container approach drives the development of composable json-schema validation systems that enforce geometric consistency rules including positive radius constraints, unit vector normalization, and polygon closure requirements. CDL template files must implement the geometry container specifications following IDS namespacing conventions with container-based prefixes for variable organization, where namespacing is used to enable variable organization without resort to highly nested structures. The validation infrastructure must support multi-machine data-trees containing ITER, WEST, and MAST geometric data while maintaining geometry container consistency across different tokamak configurations. Automated schema generation from CDL definitions requires processing scripts that compose base geometry container schemas with IDS-specific templates to produce comprehensive validation schemas capable of validating complete data-trees in single operations.

## Deliverables and Timeline

The project deliverables include extended ITER Fusion Convention specifications for geometry containers that enable spatial context attachment to data variables, composable json-schema validation systems for geometric primitives and coordinate system consistency, template CDL interface definitions for pf_active, pf_passive, wall, and magnetics IDSs following container-based namespacing, populated data-trees containing actual geometric data for ITER, WEST, and MAST tokamaks with linked experimental measurements, automated processing scripts for CDL-to-schema conversion and Zenodo publishing workflows, and comprehensive validation testing that ensures geometry container consistency across multi-machine configurations. The timeline spans six months with Phase 1 establishing geometry container foundations in Fusion Conventions, Phase 2 developing core validation schemas, Phase 3 implementing IDS-specific templates and multi-machine data-trees, and Phase 4 integrating automated validation and publishing workflows with continuous testing throughout development to maintain consistency with fusion community standards.
